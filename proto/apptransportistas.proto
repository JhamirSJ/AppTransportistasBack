syntax = "proto3";

package apptransportistas;

option go_package = "../apptransportistaspb";

service AppTransportistasService {
  rpc ObtenerDespachos (DespachoRequest) returns (stream Guia);
  rpc EnviarEntregas (stream Guia) returns (EntregaResponse);
  rpc EnviarPruebasEntrega (stream PruebaEntrega) returns (PruebaEntregaResponse);
  rpc LoginAdmin (LoginRequest) returns (LoginResponse);
  rpc EnviarTracking (stream Ubicacion) returns (TrackingResponse);
}

message DespachoRequest {
  int32 transportista_id = 1;
}

message Guia {
  string numero = 1;
  string fecha = 2;
  string codigo_cliente = 3;
  string nombre_cliente = 4;
  string nro_comprobante = 5;
  double importe_x_cobrar = 6;
  double monto_cobrado = 7;
  bool entregada = 8;
  repeated Producto productos = 9;
}

message Producto {
  string nombre = 1;
  int32 cantidad = 2;
}

message EntregaResponse {
  string mensaje = 1;
  int32 total_registradas = 2;
}

message PruebaEntrega {
  string numero_guia = 1;
  string fecha_registro = 2;
  bytes firma = 3;
  bytes imagen = 4;
}

message PruebaEntregaResponse {
  string mensaje = 1;
  int32 total_registradas = 2;
}

message LoginRequest {
  string usuario = 1;
  string password = 2;
}

message LoginResponse {
  bool success = 1;
  string mensaje = 2;
}

message Ubicacion {
    string device_id = 1;
    double latitud = 2;
    double longitud = 3;
    string fecha_hora = 4;
}

message TrackingResponse {
    string mensaje = 1;
    int32 totalRegistrados = 2;
}
